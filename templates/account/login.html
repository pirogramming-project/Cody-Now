{% extends "base.html" %}

{% block content %}
    <h2>소셜 계정으로 시작하기</h2>
    <ul>
        <li>
            <a title="Naver" href="/accounts/naver/login/?process=login">Naver</a>
        </li>
        <li>
            <a title="Google" href="/accounts/google/login/?process=login">Google</a>
        </li>
    </ul>

    <script>
        (function() {
            const ua = navigator.userAgent || navigator.vendor || window.opera;
            const isInApp = (
                ua.indexOf("KAKAOTALK") > -1 ||
                ua.indexOf("Instagram") > -1 ||
                (ua.indexOf("FBAN") > -1) || 
                (ua.indexOf("FBAV") > -1)
            );

            if (isInApp) {
                const currentURL = window.location.href;
                const cleanURL = currentURL.replace(/^https?:\/\//, '');
                
                // iOS
                if (/iPad|iPhone|iPod/.test(ua)) {
                    window.location.href = `safari-https://` + cleanURL;
                }
                // Android
                else {
                    window.location.href = `intent://${cleanURL}#Intent;scheme=https;package=com.android.chrome;end`;
                }
                
                // 모든 시도가 실패하면 2초 후 기본 브라우저로 시도
                setTimeout(function() {
                    window.location.href = `https://` + cleanURL;
                }, 2000);
            }
        })();
    </script>
{% endblock %}